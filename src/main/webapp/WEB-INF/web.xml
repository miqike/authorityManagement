<?xml version="1.0" encoding="UTF-8"?>

<web-app version="2.5"
         xmlns="http://java.sun.com/xml/ns/javaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
    http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">
<!--
<web-app xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xmlns="http://java.sun.com/xml/ns/javaee"
         xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
	http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
         metadata-complete="false" version="3.0">
-->
    <display-name>cpsi</display-name>
    <context-param>
        <param-name>webAppRootKey</param-name>
        <param-value>cpsi</param-value>
    </context-param>
    <context-param>
        <param-name>contextConfigLocation</param-name>
        <param-value>/WEB-INF/conf/spring-common.xml,/WEB-INF/conf/spring-config.xml
        </param-value>
    </context-param>
    <context-param>
        <param-name>log4jConfigLocation</param-name>
        <param-value>/WEB-INF/conf/log4j.properties</param-value>
    </context-param>
    <context-param>
        <param-name>log4jRefreshInterval</param-name>
        <param-value>60000</param-value>
    </context-param>
    <context-param>
        <param-name>spring.profiles.active</param-name>
        <!--<param-value>cas</param-value> -->
        <param-value>local</param-value>
    </context-param>

    <listener>
        <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
    </listener>

    <listener>
        <listener-class>net.sf.husky.deploy.listener.NodeDeploymentListener</listener-class>
    </listener>

    <listener>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <listener>
        <listener-class>org.springframework.web.util.IntrospectorCleanupListener</listener-class>
    </listener>

    <listener>
        <listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>
    </listener>

    <!-- Spring-Session Filter-->
    <filter>
        <filter-name>springSessionRepositoryFilter</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    <filter-mapping>
        <filter-name>springSessionRepositoryFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
    <!--
    <filter>
        <filter-name>ExpiresFilter</filter-name>
        <filter-class>org.apache.catalina.filters.ExpiresFilter</filter-class>
        <init-param>
            <param-name>ExpiresByType image</param-name>
            <param-value>access
                plus 10 minutes
            </param-value>
        </init-param>
        <init-param>
            <param-name>ExpiresByType
                text/css
            </param-name>
            <param-value>access plus 10 minutes</param-value>
        </init-param>
        <init-param>
            <param-name>ExpiresByType application/javascript</param-name>
            <param-value>access plus 10 minutes</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>ExpiresFilter</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>REQUEST</dispatcher>
    </filter-mapping>
     -->
 
    <filter>
        <filter-name>HiddenHttpMethodFilter</filter-name>
        <filter-class>org.springframework.web.filter.HiddenHttpMethodFilter</filter-class>
    </filter>

    <filter-mapping>
        <filter-name>HiddenHttpMethodFilter</filter-name>
        <servlet-name>spring</servlet-name>
    </filter-mapping>

    <filter>
        <filter-name>Set Character Encoding</filter-name>
        <filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
        <init-param>
            <param-name>forceEncoding</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>

    <filter-mapping>
        <filter-name>Set Character Encoding</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <filter>
        <filter-name>shiroFilter</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
        <init-param>
            <param-name>targetFilterLifecycle</param-name>
            <param-value>true</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>shiroFilter</filter-name>
        <url-pattern>/*</url-pattern>
        <dispatcher>REQUEST</dispatcher>
    </filter-mapping>

    <!--druid Web监控 -->
    <filter>
        <filter-name>DruidWebStatFilter</filter-name>
        <filter-class>com.alibaba.druid.support.http.WebStatFilter</filter-class>
        <init-param>
            <param-name>exclusions</param-name>
            <param-value>/static/*,*.js,*.gif,*.jpg,*.png,*.css,*.ico,/druid/*</param-value>
        </init-param>
        <init-param>
            <param-name>principalSessionName</param-name>
            <param-value>userId</param-value>
        </init-param>
    </filter>
    <filter-mapping>
        <filter-name>DruidWebStatFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>

    <!--Hessian -->
    <!-- <servlet> <servlet-name>hessian</servlet-name> <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param> <param-name>contextConfigLocation</param-name> <param-value>/WEB-INF/conf/spring-config-hessian.xml</param-value>
        </init-param> </servlet> <servlet-mapping> <servlet-name>hessian</servlet-name>
        <url-pattern>/hessian/*</url-pattern> </servlet-mapping> <servlet> <servlet-name>cxf</servlet-name>
        <servlet-class>org.apache.cxf.transport.servlet.CXFServlet</servlet-class>
        </servlet> <servlet-mapping> <servlet-name>cxf</servlet-name> <url-pattern>/ws/*</url-pattern>
        </servlet-mapping> -->

    <!--	<filter>
            <filter-name>GzipFilter</filter-name>
            <filter-class>org.eclipse.jetty.servlets.GzipFilter</filter-class>
            <async-supported>true</async-supported>
            <init-param>
                <param-name>methods</param-name>
                <param-value>GET,POST</param-value>
            </init-param>
            <init-param>
                <param-name>mimeTypes</param-name>
                <param-value>text/html,text/xml,text/plain,text/css,text/javascript,text/json,application/x-javascript,application/javascript,application/json,application/xml,application/xml+xhtml,image/svg+xml</param-value>
            </init-param>
        </filter>
        <filter-mapping>
            <filter-name>GzipFilter</filter-name>
            <url-pattern>/*</url-pattern>
        </filter-mapping>-->

    <!--
    <servlet>
        <servlet-name>activitiProxyServlet</servlet-name>
        <servlet-class>org.eclipse.jetty.proxy.ActivitiProxyServlet$Transparent</servlet-class>
        <async-supported>true</async-supported>
        <init-param>
            <param-name>proxyTo</param-name><param-value>http://192.168.5.100:8080/activiti-rest/rest/</param-value>
        </init-param>
        <init-param>
            <param-name>prefix</param-name><param-value>/activiti-rest/</param-value>
        </init-param>
        <load-on-startup>1</load-on-startup>
    </servlet>

    <servlet-mapping>
        <servlet-name>activitiProxyServlet</servlet-name>
        <url-pattern>/activiti-rest/*</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>activitiProxyServlet</servlet-name>
        <servlet-class>com.jsos.httpproxy.HttpProxyServlet</servlet-class>
        <init-param>
            <param-name>host</param-name>
            <param-value>http://192.168.5.100:8080/activiti-rest/rest/</param-value>
        </init-param>
        <init-param>
            <param-name>path</param-name>
            <param-value>true</param-value>
        </init-param>
        <init-param>
            <param-name>encoding</param-name>
            <param-value>UTF-8</param-value>
        </init-param>
        <init-param>
            <param-name>gzip</param-name>
            <param-value>false</param-value>
        </init-param>
        <init-param>
            <param-name>keepHeaders</param-name>
            <param-value>true</param-value>
        </init-param>
        <init-param>
            <param-name>certificate</param-name>
            <param-value>true</param-value>
        </init-param>
        <init-param>
            <param-name>user</param-name>
            <param-value>admin</param-value>
        </init-param>
        <init-param>
            <param-name>password</param-name>
            <param-value>000000</param-value>
        </init-param>
    </servlet>
    <servlet-mapping>
        <servlet-name>activitiProxyServlet</servlet-name>
        <url-pattern>/activiti-rest/*</url-pattern>
    </servlet-mapping>
     -->

    <servlet>
        <servlet-name>weixinServlet</servlet-name>
        <servlet-class>net.sf.husky.weixin.servlet.WxCpServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>weixinServlet</servlet-name>
        <url-pattern>/weixin/*</url-pattern>
    </servlet-mapping>

    <!-- druid监控 -->
    <servlet>
        <servlet-name>DruidStatView</servlet-name>
        <servlet-class>com.alibaba.druid.support.http.StatViewServlet</servlet-class>
    </servlet>
    <servlet-mapping>
        <servlet-name>DruidStatView</servlet-name>
        <url-pattern>/sys/druid/*</url-pattern>
    </servlet-mapping>

    <servlet>
        <servlet-name>spring</servlet-name>
        <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
        <init-param>
            <param-name>contextConfigLocation</param-name>
            <param-value>/WEB-INF/conf/spring-mvc.xml</param-value>
        </init-param>
        <load-on-startup>3</load-on-startup>
    </servlet>
    <servlet-mapping>
        <servlet-name>spring</servlet-name>
        <url-pattern>/</url-pattern>
    </servlet-mapping>

    <!-- Tomcat, Jetty, JBoss, and GlassFish 自带的默认Servlet的名字 - "default"
        Google App Engine 自带的 默认Servlet的名字 - "_ah_default"
        Resin 自带的 默认Servlet的名字 - "resin-file"
        WebLogic 自带的 默认Servlet的名字 - "FileServlet"
        WebSphere 自带的 默认Servlet的名字 - "SimpleFileServlet"
     -->
	<!-- 
    <servlet-mapping>
        <servlet-name>FileServlet</servlet-name>
        <url-pattern>*.css</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>FileServlet</servlet-name>
        <url-pattern>*.gif</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>FileServlet</servlet-name>
        <url-pattern>*.jpg</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>FileServlet</servlet-name>
        <url-pattern>*.js</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>FileServlet</servlet-name>
        <url-pattern>*.html</url-pattern>
    </servlet-mapping> 
    -->
	<servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.css</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.gif</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.jpg</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.js</url-pattern>
    </servlet-mapping>

    <servlet-mapping>
        <servlet-name>default</servlet-name>
        <url-pattern>*.html</url-pattern>
    </servlet-mapping> 
    <welcome-file-list>
        <welcome-file>index.jsp</welcome-file>
    </welcome-file-list>
    <!--<error-page> <error-code>404</error-code> <location>/WEB-INF/jsp/error/error.jsp</location>
        </error-page> <error-page> <error-code>400</error-code> <location>/WEB-INF/jsp/error/error.jsp</location>
        </error-page> <error-page> <error-code>500</error-code> <location>/WEB-INF/jsp/error/error.jsp</location>
        </error-page> <error-page> <error-code>503</error-code> <location>/WEB-INF/jsp/error/error.jsp</location>
        </error-page> <error-page> <exception-type>java.lang.Exception</exception-type>
        <location>/WEB-INF/jsp/error/error.jsp</location> </error-page> -->
<!-- 
<resource-ref>
  <description>DB Connection</description>
  <res-ref-name>jdbc/cpsiDS</res-ref-name>
  <res-type>javax.sql.DataSource</res-type>
  <res-auth>Container</res-auth>
</resource-ref> -->
</web-app>
